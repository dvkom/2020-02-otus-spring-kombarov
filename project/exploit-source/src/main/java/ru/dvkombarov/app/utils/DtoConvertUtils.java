package ru.dvkombarov.app.utils;

import ru.dvkombarov.app.domain.Exploit;
import ru.dvkombarov.app.domain.Vulnerability;
import ru.dvkombarov.app.rest.dto.ExploitDto;
import ru.dvkombarov.app.rest.dto.VulnerDto;

import java.util.Set;
import java.util.stream.Collectors;

public final class DtoConvertUtils {

  public static VulnerDto toVulnerDto(Vulnerability vulnerability) {
    Set<ExploitDto> exploitDtoSet = vulnerability.getExploits()
        .stream()
        .map(DtoConvertUtils::toExploitDto)
        .collect(Collectors.toSet());

    return new VulnerDto(
        vulnerability.getCve(),
        vulnerability.getDescription(),
        exploitDtoSet
    );
  }

  private static ExploitDto toExploitDto(Exploit exploit) {
    return new ExploitDto(
        exploit.getDescription(),
        exploit.getLink()
    );
  }
}

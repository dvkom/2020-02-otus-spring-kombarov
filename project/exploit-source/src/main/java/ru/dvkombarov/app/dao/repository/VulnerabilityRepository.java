package ru.dvkombarov.app.dao.repository;


import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.Repository;
import ru.dvkombarov.app.domain.Vulnerability;

import java.util.List;
import java.util.Optional;

public interface VulnerabilityRepository extends Repository<Vulnerability, String> {

  @Query("select v from Vulnerability v join fetch v.exploits where v.id in (:cveList)")
  List<Vulnerability> findAllByCveWithExploits(List<String> cveList);

  Optional<Vulnerability> findVulnerabilityByCve(String cve);
}
